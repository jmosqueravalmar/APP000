<div id="ListaClientes" data-role="view" data-title="Lista Clientes" data-layout="main" data-model="app.funcionalidad01" data-show="app.funcionalidad01.onShow" data-after-show="app.funcionalidad01.afterShow">
    <!-- START_CUSTOM_CODE_funcionalidad01 -->

    <div id="lstCliente"></div>
    
    <script type="text/x-kendo-tmpl" id="tmpLstCliente">
        <dl style="border-bottom-style: solid; border-bottom-color: black; border-bottom-width: thin">        
            <dt>#:ClienteNombre#</dt>
            <dd>#:ClienteRubro#</dd>
        </dl>
    </script>
    
    <!--
    NOTA: Si puo intercambiare fra kendoListView e kendoMobileListView
    ATTENZIONE: kendoMobileListView puo gestire un template specializzato per editing ** editTemplate **
    Entrambe le opzioni kendoListView e kendoMobileListView suppportano Add di nuovi item
    La f01 di AUSA richiede uso di kendoMobileListView
    -->

    <script>
        $(document).ready(function () {
            $("#lstCliente").kendoListView({
                dataSource: dsCliente,
                template: kendo.template($("#tmpLstCliente").html()),
                selectable: true,
                change: function(e) {
                    
                    var row = $(".k-state-selected").select();
                    console.log("ClienteID > " + this.dataItem(row).ClienteID);
                    $("#det-nombre").html($.trim(this.dataItem(row).ClienteNombre));
                    
                    //console.log("E > data: " + e.dataItem);

                    /*
                    *** hooks to handle kendoMobileListView data structure ***
                    $("#det-nombre").html(e.dataItem.nombre);
                    $("#det-rubro").html(e.dataItem.rubro);
                    get_Contactos_Clientes(e.dataItem.id);
                    */                    

                    //Apply the filter to the Custormer's contact list
                    dsContactosCliente.filter({field: "StrClienteID", operator: "eq", value: $.trim(this.dataItem(row).ClienteID)});
                    
                    //Change view to detail
                    window.location.href = "#det-cliente";
                }
            });
        });
    </script>

    <!-- END_CUSTOM_CODE_funcionalidad01 -->
</div>

<div data-role="view" id="det-cliente" data-title="Detalle" >
    <div data-role="navbar">
        <span data-role="view-title"></span>
        <a data-role="button" data-align="right" href="#ListaClientes">Regresar</a>
    </div>
    
    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>ACTUALIZACION CONSULTA CLIENTE</strong>
            </div>            
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-3">Fecha</div>
            <div class="col-xs-9">15 Octubre 2015</div>
         </div>
        <div class="row">
            <div class="col-xs-3">Hora</div>
            <div class="col-xs-9">16:35:52</div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>
    
    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-3">
                <strong>CLIENTE</strong>                
            </div>            
            <div id="det-nombre" class="col-xs-9">
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>
    
    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>DETALLE CONTACTOS CLIENTE</strong>
            </div>            
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-3">
                PERSONA:
            </div>
            <div class="col-xs-9">
                <input id="ContactosCliente" />
            </div>
        </div>
        <div class="row">
            <div class="col-xs-3">
                TELEFONO:
            </div>
            <div class="col-xs-9">
                <input id="TelefonosContactoCliente" />
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <button id="btnLlamar" type="button">Llamar</button>
            </div>            
        </div>
        <div class="row">
            <div class="col-xs-12">
                FECHA DE CUMPLEAÃ‘OS:
            </div>
        </div>
        <div class="row">
            <div id="FechaCumpleanos" class="col-xs-12">
                dd mmm
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>
    
    <script>
        $(document).ready(function () {            
            $("#ContactosCliente").kendoDropDownList({
                dataTextField: "ContactoNombre",
                dataValueField: "ContactoID",
                dataSource: dsContactosCliente,
                change: function(e) {
                    console.log("ContactosCliente >> change");
                    // ContactoFechaCumpleanos
                    // get the dataItem corresponding to the selectedIndex.
                    $("#FechaCumpleanos").html($.trim(this.dataItem().ContactoFechaCumpleanos)); 
                },
                dataBound: function(e) {
                    console.log("ContactosCliente >> dataBound");
                     $("#FechaCumpleanos").html($.trim("1 May.")); 
                    // dataItem from dsContactosCliente DataSource
                    console.log("ContactosCliente >> dataBound >> dataItem(0): " + this.dataItem(0).ContactoID + " -- " + this.dataItem(0).ContactoNombre + " -- " + this.dataItem(0).ContactoFechaCumpleanos);
                    // ContactoFechaCumpleanos
                    $("#FechaCumpleanos").html($.trim(this.dataItem(0).ContactoFechaCumpleanos)); 
                }
            });

            $("#TelefonosContactoCliente").kendoDropDownList({
                cascadeFrom: "ContactosCliente",
                dataTextField: "TelefonoNumero",
                dataValueField: "TelefonoID",
                dataSource: dsTelefonosContactoCliente
            });
            
            $("#btnLlamar").kendoButton({
                 click: function(e) {
                     console.log(e.event.target.tagName);                     
                     // +++ ERROR +++ Simple reference to a JQuery object
                     //console.log("Llamar numero >> " + $("#TelefonosContactoCliente").dataItem().TelefonoNumero);                     
                     console.log("Llamar numero >> " + $("#TelefonosContactoCliente").data("kendoDropDownList").dataItem().TelefonoNumero);
                     window.open('tel:' + $("#TelefonosContactoCliente").data("kendoDropDownList").dataItem().TelefonoNumero, '_system')
                 }
             });
        });
    </script>
    
   <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>SITUACION DE PAGO</strong>
            </div>            
        </div>        
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>
    
   <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>PARTICIPACION DE AUSA</strong>
            </div>            
        </div>        
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>
    
    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>PARTICIPACION OTRAS AGENCIAS </strong>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div> 
    
    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>INGRESO POR DESPACHO</strong>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>

    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>INGRESO ADUANAS</strong>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>
    
    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>CONDICIONES DE PAGO</strong>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div> 
    
    <div class="container-fluid" style="border-style: solid; border-top: white; border-left: white; border-right: white;">
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <strong>TARIFAS</strong>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                &nbsp;
            </div>
        </div>
    </div>
</div>
